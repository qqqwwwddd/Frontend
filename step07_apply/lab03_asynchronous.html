<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>lab03_asynchronous.html</title>
</head>

<body>
    <script>
        // 동기 synchronous : 요청 결과 응답 후 다음 동작이 실행되는 방식
        console.log(1);
        // setTimeout 브라우저의 내부에 동작이 실행되도록 하는 특정 공간에 잠시 저장됨
        setTimeout(() => {
            console.log(2);
        }, 1000);
        console.log(3);

        // 비동기 asychronous : 요청 결과 응답과 별개로 다음 동작이 실행되는 방식
        // 왜 필요한가? 서버로 부터 미리 데이터를 세팅하는 경우, 문제 발생 시 별도로 실행되어야 하는 경우


        // 콜백 함수 Callback Function
        // : 함수의 매개변수로 전달되는 함수 --> 결과적으로 콜백함수는 전달 받은 함수 안에서 다시 호출
        function callBack(callback) {
            setTimeout(() => {
                callback();
            }, 1000);

        };
        callBack(() => { // 익명의 또 다른 함수 호출
            console.log('1초 후에 callback 함수 실행 ');
        });

        // => 지정된 시간에 실행 ( 비동기 )
        // 콜백함수의 문제 : 콜백 안에서 또 다른 지연되는 함수가 필요할 때 또다른  

        // 콜백 지옥  : 과부하 걸림 
        // function callBack(callback) { 
        //     setTimeout(() => {
        //         callback();
        //     }, 1000);

        // }; 
        // callBack(() => { 
        //     console.log('1: 1초 후에 callback 함수 실행 ');
        // } ); 
        // callBack(() => {
        //     callBack(() => {
        //         console.log('2: 2초후에 callback함수 실행');
        //     });
        // });
        // callBack(() => {
        //     callBack(() => {
        //         callBack(() => {
        //             console.log('3: 3초후에 callback함수 실행');
        //         });
        //     });
        // });


        // Promise
        // 전역객체 (new로 생성할 필요 x)
        // console.log(Promise); //-> Promise() { [native code] }

        // Promise 문법 
        // new 연산자로 Promise 객체 생성 가능
        // 객체 생성시 실행자 함수를 인자로 받아 실행 
        // 내부에 실행자 함수를 가지는데 Promise는 진행되는 시점에 따라 상태값을 가짐
        // 실행자 함수의 종류는 두가지
        // resolve(), reject()
        new Promise((resolve, reject) => {

        });

        // 대기(pending) : 프로미스 객체가 생성되어 대기 중인 상태

        // 이행(fulfilled) : resolve()를 실행시켰을 때의 상태
        new Promise((resolve, reject) => {
            resolve();
        });
        
        // 거부(rejected) : reject()를 실행시켰을때의 상태
        new Promise((resolve, reject) => {
            reject();
        });


        // 1초 후 실행 함수
        let promiseFunction = new Promise((resolve, reject) => {
            setTimeout(() => {
                resolve(); 
            }, 1000);
        });

        console.log(promiseFunction); //->Promise {<pending>}
       
        promiseFunction.then(() => {     
            console.log('프로미스 실행');
        })
        // promise -> then -> then 내부 -> promiseFunction 안에 있던 setTimeout() 실행

    </script>
</body>

</html>